1 DIM X1$(127)
2 X1$="(C) 1983 DATABAR CORP.SN09930016"
3 DIM P$(22),D$(22),S$(144)
4 GOTO 29
11 DIM X2$(127),X$(127),XS$(22),X9$(22),XC(9,2),XP(2)
12 XS$="                      "
13 X$="202000310414614064120150411002086000361400114"
14 FOR X=1 TO 9:XC(X,1)=VAL(X$(X*5-4,X*5-2)):XC(X,2)=VAL(X$(X*5-1,X*5)):NEXT X
15 XZ=22:XO=1:XE=4:XW=9:XP(1)=375:XP(2)=387:RETURN 
16 GRAPHICS 0:POKE 752,1:GOSUB 22:RETURN 
17 XU=5:XV=3:GOSUB 16:GOSUB 22:XQ=78-LEN(X$)/2:GOSUB 23:IF XM THEN XM=XQ+LEN(X$)-22
18 X$=" ":X$(2)=X2$:X$(LEN(X$)+1)=" ":GOSUB 28:XQ=144-LEN(X$)/2:GOSUB 23:XQ=XQ+LEN(X$)-22:X$="TM":GOSUB 23
19 IF XM THEN XQ=XM:GOSUB 23
20 X$=X1$(1,22):XQ=221:GOSUB 23:RETURN 
21 FOR X=1 TO XN*425:NEXT X:RETURN 
22 POKE 710,XC(XU,1):POKE 712,XC(XV,1):POKE 709,XC(XU,2):RETURN 
23 IF XQ>0 THEN XY=INT((XQ-1)/22)+1:XX=XQ-XY*22+22
24 IF XB>0 THEN FOR X=1 TO LEN(X$):X$(X,X)=CHR$(ASC(X$(X,X))+128):NEXT X
25 POSITION XX+XW-1,XY+XE-1:PRINT X$;:XB=0:RETURN 
26 POKE 764,255:RETURN 
27 POKE 752,1:PRINT ;:OPEN #1,4,0,"K:":GET #1,XS:X9$=CHR$(XS):CLOSE #1:RETURN 
28 XB=128:RETURN 
29 GOSUB 11:X$="FOUR IN A ROW":X2$="FUNWARE":XM=1:GOSUB 17
34 XN=3:GOSUB 21
36 PS=1:XU=9:XV=1:GOSUB 16:GOSUB 22:XQ=0:S$=" ":S$(144)=" ":S$(2)=S$
49 XY=1:XX=5:X$="FOUR IN A ROW":GOSUB 23:GOSUB 400
50 XT=5:GOSUB 22:XX=2:XY=3:X$="+-----------------+":GOSUB 23:XY=12:GOSUB 23
61 XY=4:X$="+":FOR A=1 TO 8:XX=2:GOSUB 23:XX=20:GOSUB 23:XY=XY+1:NEXT A:XT=6:GOSUB 22:XX=4:XY=13:X$="1 2 3 4 5 6 7 8"
75 GOSUB 23:XT=7:GOSUB 22:XY=15:XX=2:X$="(X) PLAYER 1:":GOSUB 23:XT=2:GOSUB 22:XY=16:X$="(O) PLAYER 2:":GOSUB 23
87 XT=6:GOSUB 22:X$="? <--":XX=16:OX=PS/2:IF OX=INT(OX) THEN 97
93 XY=15:P$="X":GOSUB 23:GOTO 100
97 XY=16:P$="O":GOSUB 23
100 GOSUB 26
101 GOSUB 27:S=XY:IF (ASC(X9$)>48)*(ASC(X9$)<57) THEN 114
104 X$=" TRY AGAIN!":XQ=XP(1):XN=1.2:GOSUB 23:GOSUB 21:X$="           ":GOSUB 23:XQ=0:XY=S:GOTO 101
114 C=VAL(X9$):D$=" ":FOR R=8 TO 0 STEP -1:IF R<1 THEN 209
118 IF S$(R*10+C+1,R*10+C+1)=D$ THEN 120
119 NEXT R
120 X$=X9$:XX=16:GOSUB 23:XN=0.5:GOSUB 21:XT=2:IF P$="O" THEN 128
127 XT=7
128 GOSUB 22:LN=XY:S$(R*10+C+1,R*10+C+1)=P$:W=R:XX=2*C+2:FOR W=1 TO R:XY=W+3:X$=P$:GOSUB 23:GOSUB 23:GOSUB 23
129 X$=" ":GOSUB 23:NEXT W
140 XN=0.5:X$=P$:GOSUB 23:XX=16:XY=LN:X$="     ":GOSUB 23:PS=PS+1:MC=1:RS=R:CS=C:FOR J=-1 TO 1:FOR I=0 TO 1
153 IF ((I=0)*(J=0))+((J=-1)*(I=0)) THEN 168
154 MC=1:FOR M=1 TO 2:FOR K=1 TO 3:RS=RS+I:CS=CS+J
155 IF S$(RS*10+CS+1,RS*10+CS+1)<>P$ THEN K=4:GOTO 162
160 MC=MC+1
162 NEXT K:IF MC>=4 THEN 171
163 J=-1*J:I=-1*I:RS=R:CS=C:NEXT M
168 NEXT I:NEXT J:GOTO 220
171 FS=2
172 ON FS+1 GOTO 87,227,185
173 XY=16:XX=2:X$="PLAY AGAIN (Y/N): ?":GOSUB 23
177 GOSUB 27:IF (X9$<>"Y")*(X9$<>"N") THEN 177
179 XX=20:X$=X9$:GOSUB 23:GOSUB 21:GOSUB 16:RETURN 
185 X$="*** PLAYER 2 WINS! ***":IF P$<>"X" THEN 188
187 X$="*** PLAYER 1 WINS ***"
188 XY=15:XX=1:GOSUB 23:X$="                  ":XY=16:GOSUB 23:XY=16:XN=1.1:GOSUB 21:GOSUB 173:IF X9$="Y" THEN 36
199 GOSUB 16:XY=3:XX=2:X$="THANKS FOR PLAYING!":GOSUB 23:XQ=250:X$="":XQ=250:GOSUB 23:POKE 752,0:END 
209 T=XY:XQ=XP(1):X$="STACK IS FULL":GOSUB 23:XN=1.6:GOSUB 21:X$="             ":GOSUB 23:XQ=0:XY=T:GOTO 87
220 R2=1:FOR C2=1 TO 8:IF S$(R2*10+C2+1,R2*10+C2+1)=D$ THEN 87
223 IF C2=8 THEN 225
224 NEXT C2
225 FS=1:GOTO 172
227 XY=15:XX=1:X$="***    TIE GAME!   ***":GOSUB 23:GOSUB 173:IF X9$="N" THEN 199
228 GOTO 36
400 Q2=96:Q4=8:Q3=4:Q1=53:GOSUB 450:GOSUB 500:Q1=64
401 Q2=85:GOSUB 450:Q2=76:GOSUB 450:Q2=72:Q1=57:GOSUB 450:GOSUB 500:GOSUB 452
402 Q1=47:Q2=114:GOSUB 450:GOSUB 500:Q2=108:Q1=53:GOSUB 450:Q2=96:GOSUB 450:Q2=85:Q1=53:GOSUB 450:GOSUB 500
404 GOSUB 452:Q1=47:Q2=96:GOSUB 450:GOSUB 500:GOSUB 453:Q1=53
405 Q2=96:GOSUB 450:GOSUB 500:GOSUB 453:Q2=96:Q1=57:GOSUB 450:GOSUB 500:Q2=85:Q1=64
406 GOSUB 450:Q2=76:GOSUB 450:Q1=57:Q2=72:GOSUB 450:GOSUB 500:GOSUB 500:GOSUB 500:GOSUB 453:RETURN 
450 SOUND 0,Q2,10,Q4:SOUND 1,Q1,10,Q3:GOSUB 500:RETURN 
452 SOUND 0,0,0,0:SOUND 1,0,0,0:GOSUB 500:GOSUB 500:Q4=8:Q3=5:RETURN 
453 SOUND 0,0,0,0:Q4=8:SOUND 1,0,0,0:Q3=8:RETURN 
500 FOR K=1 TO 35:NEXT K:RETURN 
